{"dependencies":[{"name":"react","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":42,"index":42}}],"key":"RtGiGa+/H7VrI7GDQDLhO1UbpU8=","exportNames":["*"],"imports":1}},{"name":"expo-router","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":43},"end":{"line":2,"column":40,"index":83}}],"key":"/+ErnBisjrT6aDU+GRp5Qz/lYoY=","exportNames":["*"],"imports":1}},{"name":"expo-notifications","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":3,"column":0,"index":84},"end":{"line":3,"column":52,"index":136}}],"key":"nrBDtkRVez7cBhLzyaRjl+xVfvE=","exportNames":["*"],"imports":1}},{"name":"react-native-web/dist/exports/Platform","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"dV3bI3NOD8bfMzaIniMaFGy/nn8=","exportNames":["*"],"imports":1}},{"name":"./api","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":5,"column":0,"index":178},"end":{"line":5,"column":24,"index":202}}],"key":"FbKPDeRJ9TF3vg1eKYKz12urgic=","exportNames":["*"],"imports":1}},{"name":"../store/authStore","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":6,"column":0,"index":203},"end":{"line":6,"column":50,"index":253}}],"key":"/4BDl/hqolvw7T4CXD8jWAtZK4M=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function(g,r,i,a,m,_e,_d){\"use strict\";Object.defineProperty(_e,'__esModule',{value:!0}),_e.useNotificationDeepLinking=function(){const s=(0,t.useRouter)(),{isAuthenticated:o,token:u}=(0,l.useAuthStore)(),p=(0,e.useRef)(),d=(0,e.useRef)();(0,e.useEffect)(()=>(p.current=n.addNotificationReceivedListener(e=>{console.log('Notification received in foreground:',e)}),d.current=n.addNotificationResponseReceivedListener(async e=>{console.log('User interacted with notification:',e);const t=e.notification.request.content.data;if(t.notification_id&&o&&u)try{await c.default.post(`/smart-notifications/track/click/${t.notification_id}`)}catch(e){console.log('Failed to track notification click:',e)}h(t)}),()=>{p.current&&p.current.remove(),d.current&&d.current.remove()}),[o,u]);const h=e=>{if(!e)return;const{deep_link:t,listing_id:n,conversation_id:o,user_id:c,trigger_type:l,screen:u,tab:p,ticket_id:d}=e;if('/help'!==u||'tickets'!==p){if(t){const e=t.startsWith('/')?t:`/${t}`;if(e.startsWith('/listing/')){const t=e.replace('/listing/','');s.push({pathname:'/listing/[id]',params:{id:t}})}else if(e.startsWith('/chat/')){const t=e.replace('/chat/','');s.push({pathname:'/chat/[id]',params:{id:t}})}else if(e.startsWith('/user/')||e.startsWith('/profile/')){const t=e.replace(/^\\/(user|profile)\\//,'');s.push({pathname:'/seller/[id]',params:{id:t}})}else if('/help'===e||e.startsWith('/help'))s.push({pathname:'/help',params:{tab:'tickets'}});else try{s.push(e)}catch(t){console.log('Could not navigate to:',e)}return}if(n)s.push({pathname:'/listing/[id]',params:{id:n}});else if(o)s.push({pathname:'/chat/[id]',params:{id:o}});else if(c)s.push({pathname:'/seller/[id]',params:{id:c}});else if(d)s.push({pathname:'/help',params:{tab:'tickets'}});else switch(l){case'new_listing_in_category':case'similar_listing_alert':s.push('/(tabs)/explore');break;case'price_drop_saved_item':s.push('/(tabs)/favorites');break;case'message_received':case'seller_reply':s.push('/(tabs)/inbox');break;case'support_ticket_reply':s.push({pathname:'/help',params:{tab:'tickets'}});break;case'weekly_digest':s.push('/(tabs)');break;default:console.log('No specific navigation for trigger:',l)}}else s.push({pathname:'/help',params:{tab:'tickets'}})};return{handleDeepLink:h}},_e.registerForPushNotifications=async function(e){try{const{status:e}=await n.getPermissionsAsync();let t=e;if('granted'!==e){const{status:e}=await n.requestPermissionsAsync();t=e}if('granted'!==t)return console.log('Push notification permission not granted'),null;const s=(await n.getExpoPushTokenAsync({projectId:process.env.EXPO_PROJECT_ID})).data;console.log('Expo Push Token:',s);try{await c.default.post('/users/settings',{push_token:s,push_enabled:!0,platform:\"web\"}),console.log('Push token registered with backend')}catch(e){console.log('Failed to register push token with backend:',e)}return s}catch(e){return console.error('Error registering for push notifications:',e),null}},_e.trackNotificationConversion=async function(e,t,n,s){try{return await c.default.post(`/smart-notifications/track/conversion/${e}`,{conversion_type:t,conversion_value:n,entity_id:s}),!0}catch(e){return console.log('Failed to track conversion:',e),!1}},_e.getInitialNotification=async function(){return null},_e.scheduleLocalNotification=async function(e,t,n,s){return console.log('Local notifications not supported on web'),''},_e.cancelAllScheduledNotifications=async function(){return},_e.getBadgeCount=async function(){return 0},_e.setBadgeCount=async function(e){return!0};var e=r(_d[0]),t=r(_d[1]),n=(function(e){if(e&&e.__esModule)return e;var t={};return e&&Object.keys(e).forEach(function(n){var s=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(t,n,s.get?s:{enumerable:!0,get:function(){return e[n]}})}),t.default=e,t})(r(_d[2]));r(_d[3]);var s,o=r(_d[4]),c=(s=o)&&s.__esModule?s:{default:s},l=r(_d[5]);n.setNotificationHandler({handleNotification:async()=>({shouldShowAlert:!0,shouldPlaySound:!0,shouldSetBadge:!0})})});","lineCount":1,"map":[[1,93,30,0,"_e"],[1,96,30,0,"useNotificationDeepLinking"],[1,123,30,7],[1,134,31,2],[1,140,31,8,"router"],[1,143,31,17],[1,145,31,17,"useRouter"],[1,147,31,26,"useRouter"],[1,161,32,8,"isAuthenticated"],[1,177,32,10,"isAuthenticated"],[1,179,32,25,"token"],[1,185,32,27,"token"],[1,189,32,37],[1,191,32,37,"useAuthStore"],[1,193,32,49,"useAuthStore"],[1,209,33,8,"notificationListener"],[1,212,33,31],[1,214,33,31,"useRef"],[1,216,33,37,"useRef"],[1,226,34,8,"responseListener"],[1,229,34,27],[1,231,34,27,"useRef"],[1,233,34,33,"useRef"],[1,244,36,2],[1,246,36,2,"useEffect"],[1,248,36,11,"useEffect"],[1,259,36,12],[1,264,38,4,"notificationListener"],[1,266,38,25,"current"],[1,274,38,35,"Notifications"],[1,276,38,49,"addNotificationReceivedListener"],[1,308,39,7,"notification"],[1,312,40,8,"console"],[1,320,40,16,"log"],[1,324,40,20],[1,363,40,60,"notification"],[1,368,46,4,"responseListener"],[1,370,46,21,"current"],[1,378,46,31,"Notifications"],[1,380,46,45,"addNotificationResponseReceivedListener"],[1,420,47,6,"async"],[1,430,48,8,"console"],[1,438,48,16,"log"],[1,442,48,20],[1,479,48,58,"response"],[1,482,50,8],[1,488,50,14,"data"],[1,490,50,21,"response"],[1,492,50,30,"notification"],[1,505,50,43,"request"],[1,513,50,51,"content"],[1,521,50,59,"data"],[1,526,53,8],[1,529,53,12,"data"],[1,531,53,17,"notification_id"],[1,548,53,36,"isAuthenticated"],[1,551,53,55,"token"],[1,553,54,10],[1,563,55,18,"api"],[1,565,55,21,"default"],[1,573,55,22,"post"],[1,578,55,27],[1,614,55,63,"data"],[1,616,55,68,"notification_id"],[1,634,56,10],[1,635,56,12],[1,641,56,19,"error"],[1,644,57,12,"console"],[1,652,57,20,"log"],[1,656,57,24],[1,694,57,63,"error"],[1,696,58,10],[1,697,62,8,"handleDeepLink"],[1,699,62,23,"data"],[1,704,82,11],[1,709,83,10,"notificationListener"],[1,711,83,31,"current"],[1,720,84,8,"notificationListener"],[1,722,84,29,"current"],[1,730,84,37,"remove"],[1,739,86,10,"responseListener"],[1,741,86,27,"current"],[1,750,87,8,"responseListener"],[1,752,87,25,"current"],[1,760,87,33,"remove"],[1,771,90,5],[1,772,90,6,"isAuthenticated"],[1,774,90,23,"token"],[1,778,92,2],[1,784,92,8,"handleDeepLink"],[1,786,92,26,"data"],[1,790,93,4],[1,794,93,9,"data"],[1,796,93,15],[1,803,95,4],[1,809,95,10,"deep_link"],[1,819,95,12,"deep_link"],[1,821,95,21,"listing_id"],[1,832,95,23,"listing_id"],[1,834,95,33,"conversation_id"],[1,850,95,35,"conversation_id"],[1,852,95,50,"user_id"],[1,860,95,52,"user_id"],[1,862,95,59,"trigger_type"],[1,875,95,61,"trigger_type"],[1,877,95,73,"screen"],[1,884,95,75,"screen"],[1,886,95,81,"tab"],[1,890,95,83,"tab"],[1,892,95,86,"ticket_id"],[1,902,95,88,"ticket_id"],[1,905,95,102,"data"],[1,907,98,4],[1,910,98,19],[1,920,98,8,"screen"],[1,923,98,38],[1,935,98,30,"tab"],[1,937,98,4],[1,938,105,4],[1,941,105,8,"deep_link"],[1,943,105,19],[1,944,107,6],[1,950,107,12,"path"],[1,952,107,19,"deep_link"],[1,954,107,29,"startsWith"],[1,965,107,40],[1,970,107,47,"deep_link"],[1,972,107,59],[1,976,107,63,"deep_link"],[1,980,109,6],[1,983,109,10,"path"],[1,985,109,15,"startsWith"],[1,996,109,26],[1,1009,109,40],[1,1010,110,8],[1,1016,110,14,"id"],[1,1018,110,19,"path"],[1,1020,110,24,"replace"],[1,1028,110,32],[1,1040,110,45],[1,1044,111,8,"router"],[1,1046,111,15,"push"],[1,1051,111,20],[1,1052,111,22,"pathname"],[1,1061,111,32],[1,1077,111,49,"params"],[1,1084,111,57],[1,1085,111,59,"id"],[1,1092,112,6],[1,1098,112,13],[1,1101,112,17,"path"],[1,1103,112,22,"startsWith"],[1,1114,112,33],[1,1124,112,44],[1,1125,113,8],[1,1131,113,14,"id"],[1,1133,113,19,"path"],[1,1135,113,24,"replace"],[1,1143,113,32],[1,1152,113,42],[1,1156,114,8,"router"],[1,1158,114,15,"push"],[1,1163,114,20],[1,1164,114,22,"pathname"],[1,1173,114,32],[1,1186,114,46,"params"],[1,1193,114,54],[1,1194,114,56,"id"],[1,1201,115,6],[1,1207,115,13],[1,1210,115,17,"path"],[1,1212,115,22,"startsWith"],[1,1223,115,33],[1,1234,115,46,"path"],[1,1236,115,51,"startsWith"],[1,1247,115,62],[1,1260,115,76],[1,1261,116,8],[1,1267,116,14,"id"],[1,1269,116,19,"path"],[1,1271,116,24,"replace"],[1,1279,116,32],[1,1301,116,55],[1,1305,117,8,"router"],[1,1307,117,15,"push"],[1,1312,117,20],[1,1313,117,22,"pathname"],[1,1322,117,32],[1,1337,117,48,"params"],[1,1344,117,56],[1,1345,117,58,"id"],[1,1352,118,6],[1,1358,118,13],[1,1361,118,26],[1,1371,118,17,"path"],[1,1374,118,37,"path"],[1,1376,118,42,"startsWith"],[1,1387,118,53],[1,1396,119,8,"router"],[1,1398,119,15,"push"],[1,1403,119,20],[1,1404,119,22,"pathname"],[1,1413,119,32],[1,1421,119,41,"params"],[1,1428,119,49],[1,1429,119,51,"tab"],[1,1433,119,56],[1,1451,122,8],[1,1455,123,10,"router"],[1,1457,123,17,"push"],[1,1462,123,22,"path"],[1,1464,124,8],[1,1465,124,10],[1,1471,124,17,"error"],[1,1474,125,10,"console"],[1,1482,125,18,"log"],[1,1486,125,22],[1,1511,125,48,"path"],[1,1513,126,8],[1,1514,128,6],[1,1520,129,4],[1,1521,132,4],[1,1524,132,8,"listing_id"],[1,1526,133,6,"router"],[1,1528,133,13,"push"],[1,1533,133,18],[1,1534,133,20,"pathname"],[1,1543,133,30],[1,1559,133,47,"params"],[1,1566,133,55],[1,1567,133,57,"id"],[1,1570,133,61,"listing_id"],[1,1580,137,4],[1,1583,137,8,"conversation_id"],[1,1585,138,6,"router"],[1,1587,138,13,"push"],[1,1592,138,18],[1,1593,138,20,"pathname"],[1,1602,138,30],[1,1615,138,44,"params"],[1,1622,138,52],[1,1623,138,54,"id"],[1,1626,138,58,"conversation_id"],[1,1636,142,4],[1,1639,142,8,"user_id"],[1,1641,143,6,"router"],[1,1643,143,13,"push"],[1,1648,143,18],[1,1649,143,20,"pathname"],[1,1658,143,30],[1,1673,143,46,"params"],[1,1680,143,54],[1,1681,143,56,"id"],[1,1684,143,60,"user_id"],[1,1694,148,4],[1,1697,148,8,"ticket_id"],[1,1699,149,6,"router"],[1,1701,149,13,"push"],[1,1706,149,18],[1,1707,149,20,"pathname"],[1,1716,149,30],[1,1724,149,39,"params"],[1,1731,149,47],[1,1732,149,49,"tab"],[1,1736,149,54],[1,1754,154,4],[1,1761,154,12,"trigger_type"],[1,1764,155,6],[1,1768,155,11],[1,1794,156,6],[1,1798,156,11],[1,1822,157,8,"router"],[1,1824,157,15,"push"],[1,1829,157,20],[1,1848,158,8],[1,1854,159,6],[1,1858,159,11],[1,1882,160,8,"router"],[1,1884,160,15,"push"],[1,1889,160,20],[1,1910,161,8],[1,1916,162,6],[1,1920,162,11],[1,1939,163,6],[1,1943,163,11],[1,1958,164,8,"router"],[1,1960,164,15,"push"],[1,1965,164,20],[1,1982,165,8],[1,1988,166,6],[1,1992,166,11],[1,2015,167,8,"router"],[1,2017,167,15,"push"],[1,2022,167,20],[1,2023,167,22,"pathname"],[1,2032,167,32],[1,2040,167,41,"params"],[1,2047,167,49],[1,2048,167,51,"tab"],[1,2052,167,56],[1,2065,168,8],[1,2071,169,6],[1,2075,169,11],[1,2091,170,8,"router"],[1,2093,170,15,"push"],[1,2098,170,20],[1,2109,171,8],[1,2115,172,6],[1,2123,174,8,"console"],[1,2131,174,16,"log"],[1,2135,174,20],[1,2173,174,59,"trigger_type"],[1,2176,102,4],[1,2182,100,6,"router"],[1,2184,100,13,"push"],[1,2189,100,18],[1,2190,100,20,"pathname"],[1,2199,100,30],[1,2207,100,39,"params"],[1,2214,100,47],[1,2215,100,49,"tab"],[1,2219,100,54],[1,2233,178,2],[1,2239,178,9],[1,2240,178,11,"handleDeepLink"],[1,2257,179,0],[1,2259,184,0,"_e"],[1,2262,184,0,"registerForPushNotifications"],[1,2291,184,7,"async"],[1,2306,184,51,"userId"],[1,2309,185,2],[1,2313,187,4],[1,2319,187,12,"status"],[1,2326,187,20,"existingStatus"],[1,2335,187,45,"Notifications"],[1,2337,187,59,"getPermissionsAsync"],[1,2359,188,4],[1,2363,188,8,"finalStatus"],[1,2365,188,22,"existingStatus"],[1,2367,190,4],[1,2370,190,27],[1,2382,190,8,"existingStatus"],[1,2384,190,38],[1,2385,191,6],[1,2391,191,12,"status"],[1,2398,191,14,"status"],[1,2407,191,31,"Notifications"],[1,2409,191,45,"requestPermissionsAsync"],[1,2435,192,6,"finalStatus"],[1,2437,192,20,"status"],[1,2438,193,4],[1,2439,195,4],[1,2442,195,24],[1,2454,195,8,"finalStatus"],[1,2456,197,6],[1,2463,196,6,"console"],[1,2471,196,14,"log"],[1,2475,196,18],[1,2519,197,13],[1,2524,201,4],[1,2530,204,10,"pushToken"],[1,2539,201,28,"Notifications"],[1,2541,201,42,"getExpoPushTokenAsync"],[1,2563,201,64],[1,2564,202,6,"projectId"],[1,2574,202,17,"process"],[1,2582,202,25,"env"],[1,2586,202,29,"EXPO_PROJECT_ID"],[1,2605,204,32,"data"],[1,2610,206,4,"console"],[1,2618,206,12,"log"],[1,2622,206,16],[1,2641,206,36,"pushToken"],[1,2644,209,4],[1,2654,210,12,"api"],[1,2656,210,15,"default"],[1,2664,210,16,"post"],[1,2669,210,21],[1,2687,210,40],[1,2688,211,8,"push_token"],[1,2699,211,20,"pushToken"],[1,2701,212,8,"push_enabled"],[1,2715,212,22],[1,2717,213,8,"platform"],[1,2726,213,16],[1,2734,215,6,"console"],[1,2742,215,14,"log"],[1,2746,215,18],[1,2783,216,4],[1,2784,216,6],[1,2790,216,13,"error"],[1,2793,217,6,"console"],[1,2801,217,14,"log"],[1,2805,217,18],[1,2851,217,65,"error"],[1,2853,218,4],[1,2854,249,4],[1,2861,249,11,"pushToken"],[1,2862,250,2],[1,2863,250,4],[1,2869,250,11,"error"],[1,2872,252,4],[1,2879,251,4,"console"],[1,2887,251,12,"error"],[1,2893,251,18],[1,2937,251,63,"error"],[1,2940,252,11],[1,2944,253,2],[1,2945,254,0],[1,2947,259,0,"_e"],[1,2950,259,0,"trackNotificationConversion"],[1,2978,259,7,"async"],[1,2993,260,2,"notificationId"],[1,2995,261,2,"conversionType"],[1,2997,262,2,"conversionValue"],[1,2999,263,2,"entityId"],[1,3002,265,2],[1,3006,271,4],[1,3019,266,10,"api"],[1,3021,266,13,"default"],[1,3029,266,14,"post"],[1,3034,266,19],[1,3075,266,60,"notificationId"],[1,3079,266,78],[1,3080,267,6,"conversion_type"],[1,3096,267,23,"conversionType"],[1,3098,268,6,"conversion_value"],[1,3115,268,24,"conversionValue"],[1,3117,269,6,"entity_id"],[1,3127,269,17,"entityId"],[1,3132,271,11],[1,3133,272,2],[1,3134,272,4],[1,3140,272,11,"error"],[1,3143,274,4],[1,3150,273,4,"console"],[1,3158,273,12,"log"],[1,3162,273,16],[1,3192,273,47,"error"],[1,3196,274,11],[1,3197,275,2],[1,3198,276,0],[1,3200,281,0,"_e"],[1,3203,281,0,"getInitialNotification"],[1,3226,281,7,"async"],[1,3243,284,4],[1,3250,284,11],[1,3254,296,0],[1,3256,301,0,"_e"],[1,3259,301,0,"scheduleLocalNotification"],[1,3285,301,7,"async"],[1,3300,302,2,"title"],[1,3302,303,2,"body"],[1,3304,304,2,"data"],[1,3306,305,2,"triggerSeconds"],[1,3309,310,4],[1,3316,309,4,"console"],[1,3324,309,12,"log"],[1,3328,309,16],[1,3372,310,11],[1,3374,324,0],[1,3376,329,0,"_e"],[1,3379,329,0,"cancelAllScheduledNotifications"],[1,3411,329,7,"async"],[1,3428,332,4],[1,3434,335,0],[1,3436,340,0,"_e"],[1,3439,340,0,"getBadgeCount"],[1,3453,340,7,"async"],[1,3470,343,4],[1,3477,343,11],[1,3478,346,0],[1,3480,351,0,"_e"],[1,3483,351,0,"setBadgeCount"],[1,3497,351,7,"async"],[1,3512,351,36,"count"],[1,3515,354,4],[1,3522,354,11],[1,3523,357,0],[1,3525,1,0],[1,3529,1,0,"_react"],[1,3531,1,0,"r"],[1,3533,1,0,"_d"],[1,3536,1,0],[1,3540,2,0,"_expoRouter"],[1,3542,2,0,"r"],[1,3544,2,0,"_d"],[1,3547,2,0],[1,3551,3,0,"Notifications"],[1,3554],[1,3787,3,0,"_interopNamespace"],[1,3788,3,0,"r"],[1,3790,3,0,"_d"],[1,3793,3,0],[1,3798,3,52,"r"],[1,3800,3,52,"_d"],[1,3803,3,52],[1,3807,5,0],[1,3811],[1,3813,5,0,"_api"],[1,3815,5,0,"r"],[1,3817,5,0,"_d"],[1,3820,5,0],[1,3824,5,0,"api"],[1,3827],[1,3829,5,0,"_api"],[1,3833],[1,3860,6,0,"_storeAuthStore"],[1,3862,6,0,"r"],[1,3864,6,0,"_d"],[1,3867,6,0],[1,3871,9,0,"Notifications"],[1,3873,9,14,"setNotificationHandler"],[1,3896,9,37],[1,3897,10,2,"handleNotification"],[1,3916,10,22,"async"],[1,3926,10,22],[1,3927,11,4,"shouldShowAlert"],[1,3944,11,21],[1,3946,12,4,"shouldPlaySound"],[1,3963,12,21],[1,3965,13,4,"shouldSetBadge"],[1,3981,13,20],[1,3986,357,1],[1,3989]],"functionMap":{"names":["<global>","Notifications.setNotificationHandler$argument_0.handleNotification","useNotificationDeepLinking","useEffect$argument_0","Notifications.addNotificationReceivedListener$argument_0","Notifications.addNotificationResponseReceivedListener$argument_0","Notifications.getLastNotificationResponseAsync.then$argument_0","setTimeout$argument_0","<anonymous>","handleDeepLink","registerForPushNotifications","trackNotificationConversion","getInitialNotification","scheduleLocalNotification","cancelAllScheduledNotifications","getBadgeCount","setBadgeCount"],"mappings":"AAA;sBCS;IDI;OEgB;YCM;MCG;ODG;MEK;OFgB;4DGM;qBCM;WDE;OHE;WKG;KLO;GDC;yBOE;GPoF;CFG;OUK;CVsE;OWK;CXiB;OYK;CZe;OaK;CbuB;OcK;CdM;OeK;CfM;OgBK;ChBM"},"hasCjsExports":false},"type":"js/module"}]}