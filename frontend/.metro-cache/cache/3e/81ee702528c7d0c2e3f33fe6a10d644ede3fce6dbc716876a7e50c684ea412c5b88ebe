{"dependencies":[{"name":"react","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":7,"column":0,"index":145},"end":{"line":7,"column":65,"index":210}}],"key":"RtGiGa+/H7VrI7GDQDLhO1UbpU8=","exportNames":["*"],"imports":1}},{"name":"../utils/cacheManager","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":8,"column":0,"index":211},"end":{"line":8,"column":82,"index":293}}],"key":"khlnndGTcOlkIW6B06Jlcfzuf30=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  Object.defineProperty(exports, \"default\", {\n    enumerable: true,\n    get: function () {\n      return _default;\n    }\n  });\n  exports.useCacheFirst = useCacheFirst;\n  exports.useCacheFirstList = useCacheFirstList;\n  var _react = require(_dependencyMap[0], \"react\");\n  var _utilsCacheManager = require(_dependencyMap[1], \"../utils/cacheManager\");\n  /**\n   * useCacheFirst Hook\n   * React hook for cache-first data fetching pattern\n   * Eliminates loading states by showing cached data instantly\n   */\n\n  function useCacheFirst({\n    cacheKey,\n    fetcher,\n    fallbackData,\n    deps = [],\n    enabled = true,\n    onFreshData\n  }) {\n    // Try to get cached data synchronously for instant render\n    const cachedData = (0, _utilsCacheManager.getCachedSync)(cacheKey);\n\n    // Initialize state with cached data or fallback\n    const [data, setDataState] = (0, _react.useState)(cachedData ?? fallbackData);\n    const [isFetching, setIsFetching] = (0, _react.useState)(false);\n    const [isFromCache, setIsFromCache] = (0, _react.useState)(cachedData !== null);\n    const [error, setError] = (0, _react.useState)(null);\n\n    // Track if component is mounted\n    const isMounted = (0, _react.useRef)(true);\n\n    // Track if initial fetch has been done\n    const hasInitialFetch = (0, _react.useRef)(false);\n\n    // Fetch fresh data\n    const fetchFreshData = (0, _react.useCallback)(async () => {\n      if (!enabled) return;\n      setIsFetching(true);\n      setError(null);\n      try {\n        const freshData = await fetcher();\n        if (isMounted.current) {\n          setDataState(freshData);\n          setIsFromCache(false);\n          // Update cache\n          (0, _utilsCacheManager.setCacheSync)(cacheKey, freshData);\n          // Also update async cache for native\n          _utilsCacheManager.CacheManager.setCache(cacheKey, freshData);\n          // Callback\n          onFreshData?.(freshData);\n        }\n      } catch (err) {\n        if (isMounted.current) {\n          setError(err);\n          // Don't clear data on error - keep showing cached/current data\n          console.warn('[useCacheFirst] Fetch error:', err);\n        }\n      } finally {\n        if (isMounted.current) {\n          setIsFetching(false);\n        }\n      }\n    }, [cacheKey, fetcher, enabled, onFreshData]);\n\n    // Manual refresh\n    const refresh = (0, _react.useCallback)(async () => {\n      await fetchFreshData();\n    }, [fetchFreshData]);\n\n    // Set data with optimistic update\n    const setData = (0, _react.useCallback)(update => {\n      setDataState(prev => {\n        const newData = typeof update === 'function' ? update(prev) : update;\n        // Update cache immediately\n        (0, _utilsCacheManager.setCacheSync)(cacheKey, newData);\n        _utilsCacheManager.CacheManager.setCache(cacheKey, newData);\n        return newData;\n      });\n    }, [cacheKey]);\n\n    // Initial fetch and refetch on deps change\n    (0, _react.useEffect)(() => {\n      isMounted.current = true;\n\n      // If we have cached data, fetch in background\n      // If no cached data, fetch immediately\n      if (enabled) {\n        fetchFreshData();\n      }\n      return () => {\n        isMounted.current = false;\n      };\n    }, [enabled, ...deps]);\n\n    // Load cached data on mount (for native where sync read doesn't work)\n    (0, _react.useEffect)(() => {\n      if (!cachedData && enabled) {\n        _utilsCacheManager.CacheManager.getCached(cacheKey, {}).then(result => {\n          if (result && isMounted.current && !hasInitialFetch.current) {\n            setDataState(result.data);\n            setIsFromCache(true);\n          }\n        });\n      }\n    }, []);\n    return {\n      data,\n      isFetching,\n      isFromCache,\n      error,\n      refresh,\n      setData\n    };\n  }\n\n  /**\n   * Simplified hook for common list data pattern\n   */\n  function useCacheFirstList({\n    cacheKey,\n    fetcher,\n    deps = [],\n    enabled = true\n  }) {\n    return useCacheFirst({\n      cacheKey,\n      fetcher,\n      fallbackData: [],\n      deps,\n      enabled\n    });\n  }\n  var _default = useCacheFirst;\n});","lineCount":145,"map":[[7,2,172,0,"Object"],[7,8,172,0],[7,9,172,0,"defineProperty"],[7,23,172,0],[7,24,172,0,"exports"],[7,31,172,0],[8,4,172,0,"enumerable"],[8,14,172,0],[9,4,172,0,"get"],[9,7,172,0],[9,18,172,0,"get"],[9,19,172,0],[10,6,172,0],[10,13,172,0,"_default"],[10,21,172,0],[11,4,172,0],[12,2,172,0],[13,2,40,0,"exports"],[13,9,40,0],[13,10,40,0,"useCacheFirst"],[13,23,40,0],[13,26,40,0,"useCacheFirst"],[13,39,40,0],[14,2,152,0,"exports"],[14,9,152,0],[14,10,152,0,"useCacheFirstList"],[14,27,152,0],[14,30,152,0,"useCacheFirstList"],[14,47,152,0],[15,2,7,0],[15,6,7,0,"_react"],[15,12,7,0],[15,15,7,0,"require"],[15,22,7,0],[15,23,7,0,"_dependencyMap"],[15,37,7,0],[16,2,8,0],[16,6,8,0,"_utilsCacheManager"],[16,24,8,0],[16,27,8,0,"require"],[16,34,8,0],[16,35,8,0,"_dependencyMap"],[16,49,8,0],[17,2,1,0],[18,0,2,0],[19,0,3,0],[20,0,4,0],[21,0,5,0],[23,2,40,7],[23,11,40,16,"useCacheFirst"],[23,24,40,29,"useCacheFirst"],[23,25,40,33],[24,4,41,2,"cacheKey"],[24,12,41,10],[25,4,42,2,"fetcher"],[25,11,42,9],[26,4,43,2,"fallbackData"],[26,16,43,14],[27,4,44,2,"deps"],[27,8,44,6],[27,11,44,9],[27,13,44,11],[28,4,45,2,"enabled"],[28,11,45,9],[28,14,45,12],[28,18,45,16],[29,4,46,2,"onFreshData"],[30,2,47,25],[30,3,47,26],[30,5,47,52],[31,4,48,2],[32,4,49,2],[32,10,49,8,"cachedData"],[32,20,49,18],[32,23,49,21],[32,27,49,21,"getCachedSync"],[32,45,49,34],[32,46,49,34,"getCachedSync"],[32,59,49,34],[32,61,49,38,"cacheKey"],[32,69,49,46],[32,70,49,47],[34,4,51,2],[35,4,52,2],[35,10,52,8],[35,11,52,9,"data"],[35,15,52,13],[35,17,52,15,"setDataState"],[35,29,52,27],[35,30,52,28],[35,33,52,31],[35,37,52,31,"useState"],[35,43,52,39],[35,44,52,39,"useState"],[35,52,52,39],[35,54,52,43,"cachedData"],[35,64,52,53],[35,68,52,57,"fallbackData"],[35,80,52,69],[35,81,52,70],[36,4,53,2],[36,10,53,8],[36,11,53,9,"isFetching"],[36,21,53,19],[36,23,53,21,"setIsFetching"],[36,36,53,34],[36,37,53,35],[36,40,53,38],[36,44,53,38,"useState"],[36,50,53,46],[36,51,53,46,"useState"],[36,59,53,46],[36,61,53,47],[36,66,53,52],[36,67,53,53],[37,4,54,2],[37,10,54,8],[37,11,54,9,"isFromCache"],[37,22,54,20],[37,24,54,22,"setIsFromCache"],[37,38,54,36],[37,39,54,37],[37,42,54,40],[37,46,54,40,"useState"],[37,52,54,48],[37,53,54,48,"useState"],[37,61,54,48],[37,63,54,49,"cachedData"],[37,73,54,59],[37,78,54,64],[37,82,54,68],[37,83,54,69],[38,4,55,2],[38,10,55,8],[38,11,55,9,"error"],[38,16,55,14],[38,18,55,16,"setError"],[38,26,55,24],[38,27,55,25],[38,30,55,28],[38,34,55,28,"useState"],[38,40,55,36],[38,41,55,36,"useState"],[38,49,55,36],[38,51,55,51],[38,55,55,55],[38,56,55,56],[40,4,57,2],[41,4,58,2],[41,10,58,8,"isMounted"],[41,19,58,17],[41,22,58,20],[41,26,58,20,"useRef"],[41,32,58,26],[41,33,58,26,"useRef"],[41,39,58,26],[41,41,58,27],[41,45,58,31],[41,46,58,32],[43,4,60,2],[44,4,61,2],[44,10,61,8,"hasInitialFetch"],[44,25,61,23],[44,28,61,26],[44,32,61,26,"useRef"],[44,38,61,32],[44,39,61,32,"useRef"],[44,45,61,32],[44,47,61,33],[44,52,61,38],[44,53,61,39],[46,4,63,2],[47,4,64,2],[47,10,64,8,"fetchFreshData"],[47,24,64,22],[47,27,64,25],[47,31,64,25,"useCallback"],[47,37,64,36],[47,38,64,36,"useCallback"],[47,49,64,36],[47,51,64,37],[47,63,64,49],[48,6,65,4],[48,10,65,8],[48,11,65,9,"enabled"],[48,18,65,16],[48,20,65,18],[49,6,67,4,"setIsFetching"],[49,19,67,17],[49,20,67,18],[49,24,67,22],[49,25,67,23],[50,6,68,4,"setError"],[50,14,68,12],[50,15,68,13],[50,19,68,17],[50,20,68,18],[51,6,70,4],[51,10,70,8],[52,8,71,6],[52,14,71,12,"freshData"],[52,23,71,21],[52,26,71,24],[52,32,71,30,"fetcher"],[52,39,71,37],[52,40,71,38],[52,41,71,39],[53,8,73,6],[53,12,73,10,"isMounted"],[53,21,73,19],[53,22,73,20,"current"],[53,29,73,27],[53,31,73,29],[54,10,74,8,"setDataState"],[54,22,74,20],[54,23,74,21,"freshData"],[54,32,74,30],[54,33,74,31],[55,10,75,8,"setIsFromCache"],[55,24,75,22],[55,25,75,23],[55,30,75,28],[55,31,75,29],[56,10,76,8],[57,10,77,8],[57,14,77,8,"setCacheSync"],[57,32,77,20],[57,33,77,20,"setCacheSync"],[57,45,77,20],[57,47,77,21,"cacheKey"],[57,55,77,29],[57,57,77,31,"freshData"],[57,66,77,40],[57,67,77,41],[58,10,78,8],[59,10,79,8,"CacheManager"],[59,28,79,20],[59,29,79,20,"CacheManager"],[59,41,79,20],[59,42,79,21,"setCache"],[59,50,79,29],[59,51,79,30,"cacheKey"],[59,59,79,38],[59,61,79,40,"freshData"],[59,70,79,49],[59,71,79,50],[60,10,80,8],[61,10,81,8,"onFreshData"],[61,21,81,19],[61,24,81,22,"freshData"],[61,33,81,31],[61,34,81,32],[62,8,82,6],[63,6,83,4],[63,7,83,5],[63,8,83,6],[63,15,83,13,"err"],[63,18,83,16],[63,20,83,18],[64,8,84,6],[64,12,84,10,"isMounted"],[64,21,84,19],[64,22,84,20,"current"],[64,29,84,27],[64,31,84,29],[65,10,85,8,"setError"],[65,18,85,16],[65,19,85,17,"err"],[65,22,85,29],[65,23,85,30],[66,10,86,8],[67,10,87,8,"console"],[67,17,87,15],[67,18,87,16,"warn"],[67,22,87,20],[67,23,87,21],[67,53,87,51],[67,55,87,53,"err"],[67,58,87,56],[67,59,87,57],[68,8,88,6],[69,6,89,4],[69,7,89,5],[69,16,89,14],[70,8,90,6],[70,12,90,10,"isMounted"],[70,21,90,19],[70,22,90,20,"current"],[70,29,90,27],[70,31,90,29],[71,10,91,8,"setIsFetching"],[71,23,91,21],[71,24,91,22],[71,29,91,27],[71,30,91,28],[72,8,92,6],[73,6,93,4],[74,4,94,2],[74,5,94,3],[74,7,94,5],[74,8,94,6,"cacheKey"],[74,16,94,14],[74,18,94,16,"fetcher"],[74,25,94,23],[74,27,94,25,"enabled"],[74,34,94,32],[74,36,94,34,"onFreshData"],[74,47,94,45],[74,48,94,46],[74,49,94,47],[76,4,96,2],[77,4,97,2],[77,10,97,8,"refresh"],[77,17,97,15],[77,20,97,18],[77,24,97,18,"useCallback"],[77,30,97,29],[77,31,97,29,"useCallback"],[77,42,97,29],[77,44,97,30],[77,56,97,42],[78,6,98,4],[78,12,98,10,"fetchFreshData"],[78,26,98,24],[78,27,98,25],[78,28,98,26],[79,4,99,2],[79,5,99,3],[79,7,99,5],[79,8,99,6,"fetchFreshData"],[79,22,99,20],[79,23,99,21],[79,24,99,22],[81,4,101,2],[82,4,102,2],[82,10,102,8,"setData"],[82,17,102,15],[82,20,102,18],[82,24,102,18,"useCallback"],[82,30,102,29],[82,31,102,29,"useCallback"],[82,42,102,29],[82,44,102,31,"update"],[82,50,102,59],[82,54,102,64],[83,6,103,4,"setDataState"],[83,18,103,16],[83,19,103,17,"prev"],[83,23,103,21],[83,27,103,25],[84,8,104,6],[84,14,104,12,"newData"],[84,21,104,19],[84,24,104,22],[84,31,104,29,"update"],[84,37,104,35],[84,42,104,40],[84,52,104,50],[84,55,104,54,"update"],[84,61,104,60],[84,62,104,80,"prev"],[84,66,104,84],[84,67,104,85],[84,70,104,88,"update"],[84,76,104,94],[85,8,105,6],[86,8,106,6],[86,12,106,6,"setCacheSync"],[86,30,106,18],[86,31,106,18,"setCacheSync"],[86,43,106,18],[86,45,106,19,"cacheKey"],[86,53,106,27],[86,55,106,29,"newData"],[86,62,106,36],[86,63,106,37],[87,8,107,6,"CacheManager"],[87,26,107,18],[87,27,107,18,"CacheManager"],[87,39,107,18],[87,40,107,19,"setCache"],[87,48,107,27],[87,49,107,28,"cacheKey"],[87,57,107,36],[87,59,107,38,"newData"],[87,66,107,45],[87,67,107,46],[88,8,108,6],[88,15,108,13,"newData"],[88,22,108,20],[89,6,109,4],[89,7,109,5],[89,8,109,6],[90,4,110,2],[90,5,110,3],[90,7,110,5],[90,8,110,6,"cacheKey"],[90,16,110,14],[90,17,110,15],[90,18,110,16],[92,4,112,2],[93,4,113,2],[93,8,113,2,"useEffect"],[93,14,113,11],[93,15,113,11,"useEffect"],[93,24,113,11],[93,26,113,12],[93,32,113,18],[94,6,114,4,"isMounted"],[94,15,114,13],[94,16,114,14,"current"],[94,23,114,21],[94,26,114,24],[94,30,114,28],[96,6,116,4],[97,6,117,4],[98,6,118,4],[98,10,118,8,"enabled"],[98,17,118,15],[98,19,118,17],[99,8,119,6,"fetchFreshData"],[99,22,119,20],[99,23,119,21],[99,24,119,22],[100,6,120,4],[101,6,122,4],[101,13,122,11],[101,19,122,17],[102,8,123,6,"isMounted"],[102,17,123,15],[102,18,123,16,"current"],[102,25,123,23],[102,28,123,26],[102,33,123,31],[103,6,124,4],[103,7,124,5],[104,4,125,2],[104,5,125,3],[104,7,125,5],[104,8,125,6,"enabled"],[104,15,125,13],[104,17,125,15],[104,20,125,18,"deps"],[104,24,125,22],[104,25,125,23],[104,26,125,24],[106,4,127,2],[107,4,128,2],[107,8,128,2,"useEffect"],[107,14,128,11],[107,15,128,11,"useEffect"],[107,24,128,11],[107,26,128,12],[107,32,128,18],[108,6,129,4],[108,10,129,8],[108,11,129,9,"cachedData"],[108,21,129,19],[108,25,129,23,"enabled"],[108,32,129,30],[108,34,129,32],[109,8,130,6,"CacheManager"],[109,26,130,18],[109,27,130,18,"CacheManager"],[109,39,130,18],[109,40,130,19,"getCached"],[109,49,130,28],[109,50,130,32,"cacheKey"],[109,58,130,40],[109,60,130,42],[109,61,130,43],[109,62,130,44],[109,63,130,45],[109,64,130,46,"then"],[109,68,130,50],[109,69,130,51,"result"],[109,75,130,57],[109,79,130,61],[110,10,131,8],[110,14,131,12,"result"],[110,20,131,18],[110,24,131,22,"isMounted"],[110,33,131,31],[110,34,131,32,"current"],[110,41,131,39],[110,45,131,43],[110,46,131,44,"hasInitialFetch"],[110,61,131,59],[110,62,131,60,"current"],[110,69,131,67],[110,71,131,69],[111,12,132,10,"setDataState"],[111,24,132,22],[111,25,132,23,"result"],[111,31,132,29],[111,32,132,30,"data"],[111,36,132,34],[111,37,132,35],[112,12,133,10,"setIsFromCache"],[112,26,133,24],[112,27,133,25],[112,31,133,29],[112,32,133,30],[113,10,134,8],[114,8,135,6],[114,9,135,7],[114,10,135,8],[115,6,136,4],[116,4,137,2],[116,5,137,3],[116,7,137,5],[116,9,137,7],[116,10,137,8],[117,4,139,2],[117,11,139,9],[118,6,140,4,"data"],[118,10,140,8],[119,6,141,4,"isFetching"],[119,16,141,14],[120,6,142,4,"isFromCache"],[120,17,142,15],[121,6,143,4,"error"],[121,11,143,9],[122,6,144,4,"refresh"],[122,13,144,11],[123,6,145,4,"setData"],[124,4,146,2],[124,5,146,3],[125,2,147,0],[127,2,149,0],[128,0,150,0],[129,0,151,0],[130,2,152,7],[130,11,152,16,"useCacheFirstList"],[130,28,152,33,"useCacheFirstList"],[130,29,152,37],[131,4,153,2,"cacheKey"],[131,12,153,10],[132,4,154,2,"fetcher"],[132,11,154,9],[133,4,155,2,"deps"],[133,8,155,6],[133,11,155,9],[133,13,155,11],[134,4,156,2,"enabled"],[134,11,156,9],[134,14,156,12],[135,2,162,0],[135,3,162,1],[135,5,162,3],[136,4,163,2],[136,11,163,9,"useCacheFirst"],[136,24,163,22],[136,25,163,28],[137,6,164,4,"cacheKey"],[137,14,164,12],[138,6,165,4,"fetcher"],[138,13,165,11],[139,6,166,4,"fallbackData"],[139,18,166,16],[139,20,166,18],[139,22,166,20],[140,6,167,4,"deps"],[140,10,167,8],[141,6,168,4,"enabled"],[142,4,169,2],[142,5,169,3],[142,6,169,4],[143,2,170,0],[144,2,172,0],[144,6,172,0,"_default"],[144,14,172,0],[144,17,172,15,"useCacheFirst"],[144,30,172,28],[145,0,172,29],[145,3]],"functionMap":{"names":["<global>","useCacheFirst","fetchFreshData","refresh","setData","setDataState$argument_0","useEffect$argument_0","<anonymous>","CacheManager.getCached.then$argument_0","useCacheFirstList"],"mappings":"AAA;OCuC;qCCwB;GD8B;8BEG;GFE;8BGG;iBCC;KDM;GHC;YKG;WCS;KDE;GLC;YKG;mDEE;OFK;GLE;CDU;OSK;CTkB"},"hasCjsExports":false},"type":"js/module"}]}